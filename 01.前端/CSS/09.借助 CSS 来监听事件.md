# [å€ŸåŠ© CSS æ¥ç›‘å¬äº‹ä»¶](https://juejin.cn/post/7143051955810598926).

å¹³æ—¶å·¥ä½œä¸­å¾ˆå¤šåœºåˆéƒ½è¦ç”¨åˆ°å®šæ—¶å™¨ï¼Œæ¯”å¦‚å»¶è¿ŸåŠ è½½ã€å®šæ—¶æŸ¥è¯¢ç­‰ç­‰ï¼Œä½†å®šæ—¶å™¨çš„æ§åˆ¶æœ‰æ—¶å€™ä¼šæœ‰äº›è®¸éº»çƒ¦ï¼Œæ¯”å¦‚é¼ æ ‡ç§»å…¥åœæ­¢ã€ç§»å‡ºå†é‡æ–°å¼€å§‹ã€‚è¿™æ¬¡ä»‹ç»å‡ ä¸ªå€ŸåŠ© CSS æ¥æ›´å¥½çš„æ§åˆ¶å®šæ—¶å™¨çš„æ–¹æ³•ï¼Œä¸€èµ·äº†è§£ä¸€ä¸‹å§ï¼Œç›¸ä¿¡å¯ä»¥å¸¦æ¥ä¸ä¸€æ ·çš„ä½“éªŒ

## ä¸€ã€hover å»¶æ—¶è§¦å‘

æœ‰è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼Œåœ¨é¼ æ ‡åœç•™åœ¨ä¸€ä¸ªå…ƒç´ ä¸Š`1s`åæ‰è§¦å‘äº‹ä»¶ï¼Œä¸æ»¡`1s`å°±ä¸ä¼šè§¦å‘ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œå¯ä»¥é¿å…é¼ æ ‡åœ¨å¿«é€Ÿåˆ’è¿‡æ—¶ï¼Œé¢‘ç¹çš„è§¦å‘äº‹ä»¶ã€‚å¦‚æœæ˜¯ç”¨`js`æ¥å®ç°ï¼Œå¯èƒ½ä¼šè¿™æ ·

```js
var timer = null
el.addEventListener('mouseover', () => {
  timer && clearTimeout(timer)
  timer = setTimeout(() => {
    // å…·ä½“é€»è¾‘
  }, 1000)
})
```

æ˜¯ä¸æ˜¯è¿™æ ·ï¼Ÿç­‰ç­‰ï¼Œè¿™æ ·è¿˜æ²¡å®Œï¼Œè¿™æ ·åªåšåˆ°äº†å»¶æ—¶ï¼Œé¼ æ ‡ç¦»å¼€ä»¥åè¿˜æ˜¯ä¼šè§¦å‘ï¼Œè¿˜éœ€è¦åœ¨é¼ æ ‡ç¦»å¼€æ—¶å–æ¶ˆå®šæ—¶å™¨

```js
el.addEventListener('mouseout', () => {
  timer && clearTimeout(timer)
})
```

å¦å¤–ï¼Œ**åœ¨ä½¿ç”¨`mouseout`æ—¶è¿˜éœ€è¦è€ƒè™‘ `dom` åµŒå¥—ç»“æ„**ï¼Œå› ä¸ºè¿™äº›äº‹ä»¶åœ¨`çˆ¶çº§ -> å­çº§`çš„è¿‡ç¨‹ä¸­ä»ç„¶ä¼šè§¦å‘ï¼Œæ€»ä¹‹ï¼Œç»†èŠ‚ä¼šéå¸¸å¤šï¼Œå¾ˆå®¹æ˜“è¯¯è§¦å‘ã€‚

ç°åœ¨è½¬æŠ˜æ¥äº†ï¼Œå¦‚æœå€Ÿç”¨ CSS å°±å¯ä»¥æœ‰æ•ˆåœ°é¿å…ä¸Šè¿°é—®é¢˜ï¼Œå¦‚ä¸‹ï¼Œå…ˆç»™éœ€è¦è§¦å‘çš„å…ƒç´ åŠ ä¸€ä¸ªæœ‰å»¶æ—¶çš„`transition`

```css
button:hover{
  opacity: 0.999; /*æ— å…³ç´§è¦çš„æ ·å¼*/
  transition: 0s 1s opacity; /*å»¶æ—¶ 1s */
}
```

è¿™é‡Œåªéœ€ä¸€ä¸ªæ— å…³ç´§è¦çš„æ ·å¼å°±è¡Œï¼Œå¦‚æœ`opacity`å·²ç»ä½¿ç”¨è¿‡äº†ï¼Œå¯ä»¥ä½¿ç”¨å…¶ä»–çš„ï¼Œæ¯”å¦‚`transform:translateZ(.1px)`ï¼Œä¹Ÿæ˜¯å¯è¡Œçš„ã€‚ç„¶åæ·»åŠ ç›‘å¬`transitionend`æ–¹æ³•

> [GlobalEventHandlers.ontransitionend - Web API æ¥å£å‚è€ƒ | MDN (mozilla.org)](https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FElement%2Ftransitionend_event)

```js
el.addEventListener('transitionend', () => {
  // å…·ä½“é€»è¾‘
})
```

è¿™å°±ç»“æŸäº†ã€‚æ— éœ€å®šæ—¶å™¨ï¼Œä¹Ÿæ— éœ€å–æ¶ˆï¼Œæ›´æ— éœ€è€ƒè™‘ `dom` ç»“æ„ï¼Œå®Œç¾å®ç°ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªå°å®ä¾‹ï¼Œåœ¨`hover`ä¸€æ®µæ—¶é—´åè§¦å‘`alert`

<img src="09.å€ŸåŠ© CSS æ¥ç›‘å¬äº‹ä»¶.assets/0e6931535445419cb2bcf2165dc7b942tplv-k3u1fbpfcp-zoom-in-crop-mark4536000.webp" alt="Kapture 2022-09-11 at 15.56.37" style="zoom:33%;" />

åŸç†å’Œä¸Šé¢ä¸€è‡´ï¼Œå®Œæ•´ä»£ç å¯ä»¥æŸ¥çœ‹çº¿ä¸Šdemoï¼š[hover_alert (codepen.io)](https://link.juejin.cn?target=https%3A%2F%2Fcodepen.io%2Fxboxyan%2Fpen%2FExLgXrw)æˆ–è€…[hover_alert(runjs.work)](https://link.juejin.cn?target=https%3A%2F%2Frunjs.work%2Fprojects%2Fdb0bdceb7cd343f9)

> ğŸ¤”ä»¥åå†ç¢°åˆ°è¿™æ ·çš„éœ€è¦å¯ä»¥åœä¸‹æ¥æ€è€ƒä¸€ç•ªï¼Œå¾ˆå¤šå’Œ`mouseover`æœ‰å…³çš„äº¤äº’éƒ½å¯ä»¥ç”¨è¿™ç§æ–¹å¼æ¥å®ç°

## äºŒã€é•¿æŒ‰è§¦å‘äº‹ä»¶

é•¿æŒ‰ä¹Ÿæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„éœ€æ±‚ï¼Œå®ƒå¯ä»¥å¾ˆå¥½çš„å’Œç‚¹å‡»äº‹ä»¶åŒºåˆ†å¼€æ¥ï¼Œä»è€Œèµ‹äºˆæ›´å¤šçš„äº¤äº’èƒ½åŠ›ã€‚

ä½†æ˜¯åŸç”Ÿ`js`ä¸­å´æ²¡æœ‰è¿™æ ·ä¸€ä¸ªäº‹ä»¶ï¼Œå¦‚æœè¦å®ç°é•¿æŒ‰äº‹ä»¶ï¼Œé€šå¸¸éœ€è¦å€ŸåŠ©å®šæ—¶å™¨å’Œé¼ æ ‡æŒ‰ä¸‹äº‹ä»¶ï¼Œå¦‚ä¸‹

```js
el.onmousedown = function(){
    this.timer && clearTimeout(this.timer);
    this.timer = settimeout(function(){
        //ä¸šåŠ¡ä»£ç 
    },1000)
}
el.onmouseup = function(){
    this.timer && clearTimeout(this.timer);
}
```

åˆæ˜¯å®šæ—¶å™¨å’Œå–æ¶ˆå®šæ—¶å™¨çš„åœºæ™¯ï¼Œå’Œå‰é¢ä¸€ä¸ªä¾‹å­æœ‰äº›ç±»ä¼¼ï¼Œä¹Ÿå¯ä»¥å€ŸåŠ© CSS æ¥å®ç°ï¼Œç”±äºæ˜¯é¼ æ ‡æŒ‰ä¸‹ï¼Œå¯ä»¥è”æƒ³åˆ°`:active`ï¼Œå› æ­¤å¯ä»¥è¿™æ ·æ¥å®ç°

```css
button:hover:active{
  opacity: .999; /*æ— å…³ç´§è¦çš„æ ·å¼*/
  transition: opacity 1s; /*å»¶æ—¶ 1s */
}
```

ç„¶åå†ç›‘å¬`transitionend`æ–¹æ³•

```js
el.addEventListener('transitionend', () => {
  // å…·ä½“é€»è¾‘
})
```

æ˜¯ä¸æ˜¯éå¸¸æ–¹ä¾¿å‘¢ï¼Ÿä¸‹é¢æ˜¯ä»¥å‰åšè¿‡çš„ä¸€ä¸ªå°æ¡ˆä¾‹ï¼Œå®ç°äº†é•¿æŒ‰è§¦å‘å…ƒç´ é€‰ä¸­

<img src="09.å€ŸåŠ© CSS æ¥ç›‘å¬äº‹ä»¶.assets/a7501c03ea6b4e0fa72a3f04cb39d0d7tplv-k3u1fbpfcp-zoom-in-crop-mark4536000.webp" alt="Kapture 2022-09-13 at 10.37.01" style="zoom:33%;" />

å®Œæ•´ä»£ç å¯ä»¥æŸ¥çœ‹çº¿ä¸Šdemoï¼š[é•¿æŒ‰æ¡†é€‰ (codepen.io)](https://link.juejin.cn?target=https%3A%2F%2Fcodepen.io%2Fxboxyan%2Fpen%2FgJdzoN)æˆ–è€…[é•¿æŒ‰æ¡†é€‰ (runjs.work)](https://link.juejin.cn?target=https%3A%2F%2Frunjs.work%2Fprojects%2Fa98c3826a6a646fe)

## ä¸‰ã€è½®æ’­å’Œæš‚åœ

å†æ¥çœ‹ä¸€ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„ä¾‹å­ï¼Œè½®æ’­å›¾ã€‚

é€šå¸¸è½®æ’­å›¾éƒ½ä¼šè‡ªåŠ¨æ’­æ”¾ï¼Œç„¶åé¼ æ ‡`hover`æ—¶ä¼šæš‚åœè½®æ’­å›¾ï¼Œé€šå¸¸çš„åšæ³•æ˜¯è¿™æ ·çš„

```js
function autoPlay(){
  timer && clearInterval(timer)
  timer = setInterval(function(){
    // è½®æ’­é€»è¾‘
  }, 1000)
}
autoPlay()
view.onmouseover = function(){
    timer && clearInterval(timer)
}
el.onmouseout = function(){
    autoPlay()
}
```

åˆæ˜¯å®šæ—¶å™¨çš„å–æ¶ˆå’Œè®¾ç½®ï¼Œè¦ç»‘å®šä¸€å †äº‹ä»¶ï¼Œå¤ªçƒ¦äººäº†ï¼Œå¯ä»¥æ¢ç§æ–¹å¼å—ï¼Ÿå½“ç„¶å¯ä»¥äº†ï¼Œå€ŸåŠ© CSS åŠ¨ç”»ï¼Œä¸€åˆ‡éƒ½å¥½åŠäº†ã€‚

å’Œå‰é¢ä¸å¤ªç›¸åŒçš„æ˜¯ï¼Œè¿™é‡Œæ˜¯`setInterval`ï¼Œå¯ä»¥é‡å¤è§¦å‘ï¼Œé‚£ CSS ä¸­æœ‰ä»€ä¹ˆå¯ä»¥é‡å¤è§¦å‘çš„å‘¢ï¼Ÿæ²¡é”™ï¼Œå°±æ˜¯ **CSS åŠ¨ç”»**ï¼å½“ CSS åŠ¨ç”»è®¾ç½®æ¬¡æ•°ä¸º`infinite`å°±å¯ä»¥æ— é™å¾ªç¯äº†ï¼Œå’Œè¿™ä¸ªå®šæ—¶å™¨æ•ˆæœéå¸¸ç±»ä¼¼ï¼Œè€Œä¸”å¯ä»¥ç›´æ¥é€šè¿‡`:hover`æš‚åœå’Œæ’­æ”¾åŠ¨ç”»ã€‚ç›‘å¬æ¯æ¬¡åŠ¨ç”»çš„è§¦å‘å¯ä»¥ç”¨`animationiteration`è¿™ä¸ªæ–¹æ³•ï¼Œè¡¨ç¤ºæ¯ä¸ªåŠ¨ç”»è½®å›å°±è§¦å‘ä¸€æ¬¡

> [GlobalEventHandlers.onanimationiteration - Web API æ¥å£å‚è€ƒ | MDN (mozilla.org)](https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FElement%2Fanimationiteration_event)

æ‰€ä»¥ç”¨è¿™ç§æ€è·¯å®ç°å°±æ˜¯

```css
.view {
  animation: scroll 1s infinite; /*æ¯1såŠ¨ç”»ï¼Œæ— é™å¾ªç¯*/
}
.view:hover{
  animation-play-state: paused; /*hoveræš‚åœ*/
}
@keyframes scroll {
  to {
    transform: translateZ(.1px); /*æ— å…³ç´§è¦çš„æ ·å¼*/
  }
}
```

ç„¶åå†ç›‘å¬`animationiteration`äº‹ä»¶

```js
view.addEventListener("animationiteration", () => {
  // è½®æ’­é€»è¾‘
})
```

æ˜¯ä¸æ˜¯çœå»äº†å¤§åŠçš„`js`ä»£ç ï¼Ÿè€Œä¸”ä¹Ÿæ›´å¥½ç†è§£ï¼Œæ§åˆ¶ä¹Ÿæ›´ä¸ºæ–¹ä¾¿ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªé€šè¿‡`animationiteration`æ¥ä»£æ›¿`setInterval`å®ç°çš„è½®æ’­å›¾

<img src="09.å€ŸåŠ© CSS æ¥ç›‘å¬äº‹ä»¶.assets/6fb08d9218244c2da17ab1777fbcd4c1tplv-k3u1fbpfcp-zoom-in-crop-mark4536000.webp" alt="Kapture 2022-09-11 at 16.43.49" style="zoom:33%;" />

å®Œæ•´ä»£ç å¯ä»¥æŸ¥çœ‹çº¿ä¸Šdemoï¼š[CSS banner(codepen.io)](https://link.juejin.cn?target=https%3A%2F%2Fcodepen.io%2Fxboxyan%2Fpen%2FjOxMwXW)æˆ–è€…[css_banner(runjs.work)](https://link.juejin.cn?target=https%3A%2F%2Frunjs.work%2Fprojects%2Fb92fc709ee5e4594)

## å››ã€æ€»ç»“ä¸€ä¸‹

ä»¥ä¸Šå°±æ˜¯ä½ å¯èƒ½ä¸éœ€è¦å®šæ—¶å™¨çš„å‡ ä¸ªæ›¿ä»£æ–¹æ¡ˆï¼Œç›¸æ¯”å®šæ—¶å™¨è€Œè¨€ï¼ŒCSS åœ¨æ§åˆ¶å®šæ—¶å™¨çš„å¼€å¯å’Œæš‚åœä¸Šæ›´æœ‰ä¼˜åŠ¿ï¼Œä¸‹é¢æ€»ç»“ä¸€ä¸‹

1. `:hover`é…åˆ`transition`å»¶æ—¶ã€`transitionend`ç›‘å¬å¯ä»¥å®ç°é¼ æ ‡ç»è¿‡å»¶æ—¶è§¦å‘æ•ˆæœ
2. `:active`é…åˆ`transition`å»¶æ—¶ã€`transitionend`ç›‘å¬å¯ä»¥å®ç°é•¿æŒ‰è§¦å‘æ•ˆæœ
3. CSS åŠ¨ç”»è®¾ç½®`infinite`åé…åˆ`animationiteration`ç›‘å¬å¯ä»¥å®ç°å‘¨æœŸæ€§è§¦å‘æ•ˆæœ
4. å¯ä»¥ç›´æ¥é€šè¿‡`:hover`æ¥æ§åˆ¶å°åŠ¨ç”»çš„æš‚åœå’Œæ’­æ”¾

å½“ç„¶ï¼Œå¯ä»¥åˆ©ç”¨çš„ä¸ä»…ä»…æ˜¯ä»¥ä¸Šå‡ ä¸ªæ¡ˆä¾‹ï¼Œä»»ä½•å’Œ CSS äº¤äº’ï¼ˆ`:hover`ã€`:active`ï¼‰æœ‰ç±»ä¼¼åŠŸèƒ½çš„éƒ½å¯ä»¥æœè¿™ä¸ªæ–¹å‘å»æ€è€ƒï¼Œæ˜¯ä¸æ˜¯å¯ä»¥å®ç°åœ°æ›´åŠ ä¼˜é›…ï¼ŸğŸ¤”



ä½œè€…ï¼šXboxYan
é“¾æ¥ï¼šhttps://juejin.cn/post/7143051955810598926
æ¥æºï¼šç¨€åœŸæ˜é‡‘
è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚

# ä»£ç ç¤ºä¾‹

## ä¸€ã€hover å»¶æ—¶è§¦å‘(hover_alert)

```html
    <style>
      html,
      body {
        margin: 0;
        height: 100%;
        display: grid;
        place-content: center;
      }
      button {
        position: relative;
        font-size: 60px;
        border: 0;
        background-color: rgba(144, 41, 247, 0.515);
        padding: 0.5em 1em;
        color: #fff;
        border-radius: 0.2em;
        cursor: pointer;
        overflow: hidden;
      }
      button::before {
        content: "";
        position: absolute;
        inset: 0;
        background-color: #d573ff;
        z-index: -1;
        width: 0%;
      }

      button:hover::before {
        width: 100%;
        transition: width 2s;
      }
    </style>

    <button id="btn">hover me</button>

    <script>
      btn.addEventListener("transitionend", (ev) => {
        alert("è§¦å‘äº†");
      });
    </script>
```

## äºŒã€é•¿æŒ‰è§¦å‘äº‹ä»¶(é•¿æŒ‰é€‰æ¡†)

```html
    <style>
      body {
        margin: 50px;
        counter-reset: num;
      }
      .box {
        display: inline-block;
        width: 100px;
        height: 100px;
        margin: 10px;
        background-color: gray;
      }
      .box::after {
        counter-increment: num;
        content: counter(num);
        display: flex;
        height: 100%;
        justify-content: center;
        align-items: center;
        color: #fff;
      }
      .box.active {
        background-color: skyblue;
      }
      .box:hover:active {
        opacity: 0.99;
        transition: opacity 0.35s; /**é•¿æŒ‰æ—¶é•¿**/
      }
      /** 
  è¿™é‡Œæœ‰è¯¦ç»†æè¿°
https://github.com/XboxYan/notes/issues/4 
**/
    </style>
    <script>
      var fragment = document.createDocumentFragment();
      //ä¾¿äºæµ‹è¯•ï¼Œè¿™é‡Œç”Ÿæˆäº†200ä¸ª
      for (var i = 0; i < 200; i++) {
        var box = document.createElement("div");
        box.className = "box";
        box.draggable = false;
        fragment.appendChild(box);
      }
      document.body.appendChild(fragment);

      document.addEventListener("transitionend", longclick);

      document.addEventListener("mouseup", handleup);

      document.addEventListener("touchend", handleup);

      var start = [];

      function longclick(ev) {
        if (ev.target.className.includes("box")) {
          ev.target.classList.add("active");
          document.addEventListener("mousemove", handlemove);
          document.addEventListener("touchmove", handlemove);
        }
      }

      function handleup(ev) {
        if (start.length) {
          start.length = 0;
        } else {
          if (!ev.target.className.includes("box")) {
            clear();
          }
        }
        window.getSelection().removeAllRanges();
        document.removeEventListener("mousemove", handlemove);
        document.removeEventListener("touchmove", handlemove);
      }

      function handlemove(ev) {
        var ev = (ev.touches && ev.touches[0]) || ev;
        if (!start.length) {
          start = [ev.pageX, ev.pageY];
        }
        document.querySelectorAll(".box").forEach(function (el) {
          var _x = Math.min(start[0], ev.pageX);
          var _y = Math.min(start[1], ev.pageY);
          var _l = Math.max(start[0], ev.pageX);
          var _t = Math.max(start[1], ev.pageY);
          // var rect = el.getBoundingClientRect();
          var $w = el.offsetWidth;
          var $h = el.offsetHeight;
          var $x = el.offsetLeft;
          var $y = el.offsetTop;
          var $l = $x + $w;
          var $t = $y + $h;
          if ($l - $w < _l && $l > _x && $t - $h <= _t && $t >= _y) {
            el.classList.add("active");
          } else {
            el.classList.remove("active");
          }
        });
      }

      function clear() {
        document.querySelectorAll(".box").forEach(function (el) {
          el.classList.remove("active");
        });
      }
    </script>
```

## ä¸‰ã€è½®æ’­å’Œæš‚åœ(CSS banner)

```html
    <style>
      html,
      body {
        margin: 0;
        height: 100%;
        display: grid;
        place-content: center;
      }
      .view {
        position: relative;
        width: 400px;
        height: 250px;
        counter-reset: num 0;
        animation: scroll 1s infinite;
        overflow: hidden;
      }
      .view:hover {
        animation-play-state: paused;
      }
      @keyframes scroll {
        to {
          transform: translateZ(0.1px);
        }
      }
      .inner {
        display: flex;
        height: 100%;
        transform: translateX(calc(-100% * var(--index, 0)));
        transition: 0.3s;
      }
      .item {
        width: 100%;
        height: 100%;
        flex-shrink: 0;
        display: grid;
        place-content: center;
        counter-increment: num;
        background-color: blueviolet;
        color: #fff;
        transition: 1s;
        transform: translate3d(0, 0, -100px);
        /* opacity: 0; */
      }
      .item::after {
        content: counter(num);
        font-size: 60px;
      }
      .item:nth-child(2n + 1) {
        background: tomato;
      }
      .item:nth-child(3n + 2) {
        background: royalblue;
      }
      .item:nth-child(5n + 3) {
        background: violet;
      }
      .item:nth-child(7n + 4) {
        background: tan;
        color: #333;
      }
      .item:nth-child(11n + 5) {
        background: yellowgreen;
      }
    </style>
    <div class="view" id="view">
      <div class="inner">
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
        <div class="item"></div>
      </div>
    </div>
    <script>
      view.addEventListener("animationiteration", () => {
        const index = getComputedStyle(view).getPropertyValue("--index") || 0;
        const len = view.querySelectorAll(".item").length;
        if (index == len - 1) {
          view.style.setProperty("--index", 0);
        } else {
          view.style.setProperty("--index", Number(index) + 1);
        }
      });
    </script>
```

